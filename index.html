<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta property="og:type" content="website">
<meta property="og:title" content="长毛大好的根据地">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="长毛大好的根据地">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="长毛大好的根据地">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>长毛大好的根据地</title>
  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?75c8a36e7d13eec4a16cf804bf7e3db2";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">长毛大好的根据地</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">编程 量化投资</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/05/PE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/05/PE/" itemprop="url">PE因子</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-05T12:26:43+08:00">
                2017-09-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>将所有股票按PE（未排除负值）等分成十组回测2010年以来的表现。净值如下表：</p>
<table>
<thead>
<tr>
<th>年度</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010-12-31</td>
<td>1.119191</td>
<td>1.070826</td>
<td>1.141632</td>
<td>1.101885</td>
<td>1.184569</td>
<td>1.173388</td>
<td>1.021195</td>
<td>0.964151</td>
<td>1.047078</td>
<td>1.102712</td>
</tr>
<tr>
<td>2011-12-31</td>
<td>0.793106</td>
<td>0.705675</td>
<td>0.770474</td>
<td>0.767458</td>
<td>0.825375</td>
<td>0.833913</td>
<td>0.721504</td>
<td>0.706716</td>
<td>0.800896</td>
<td>0.821467</td>
</tr>
<tr>
<td>2012-12-31</td>
<td>0.816924</td>
<td>0.670423</td>
<td>0.750001</td>
<td>0.755875</td>
<td>0.852105</td>
<td>0.856874</td>
<td>0.718348</td>
<td>0.728700</td>
<td>0.893689</td>
<td>0.835548</td>
</tr>
<tr>
<td>2013-12-31</td>
<td>0.956197</td>
<td>0.880262</td>
<td>1.033088</td>
<td>1.046277</td>
<td>1.086681</td>
<td>1.115388</td>
<td>0.906592</td>
<td>0.839023</td>
<td>0.922122</td>
<td>1.013749</td>
</tr>
<tr>
<td>2014-12-31</td>
<td>1.459287</td>
<td>1.262079</td>
<td>1.513161</td>
<td>1.486551</td>
<td>1.533802</td>
<td>1.583663</td>
<td>1.307983</td>
<td>1.252982</td>
<td>1.500618</td>
<td>1.544912</td>
</tr>
<tr>
<td>2015-12-31</td>
<td>2.722222</td>
<td>2.411039</td>
<td>3.099778</td>
<td>2.855750</td>
<td>2.808374</td>
<td>2.866146</td>
<td>2.241260</td>
<td>2.057671</td>
<td>2.378270</td>
<td>2.887383</td>
</tr>
<tr>
<td>2016-12-31</td>
<td>2.316192</td>
<td>2.041461</td>
<td>2.528157</td>
<td>2.419570</td>
<td>2.507458</td>
<td>2.674261</td>
<td>2.069909</td>
<td>1.912371</td>
<td>2.333369</td>
<td>2.717718</td>
</tr>
<tr>
<td>2017-12-31</td>
<td>1.972584</td>
<td>1.749256</td>
<td>2.177076</td>
<td>2.095869</td>
<td>2.302798</td>
<td>2.559453</td>
<td>2.057287</td>
<td>1.988030</td>
<td>2.586845</td>
<td>2.531217</td>
</tr>
</tbody>
</table>
<p>每年的回报如下：</p>
<table>
<thead>
<tr>
<th>年度</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<td>2011</td>
<td>-0.291358</td>
<td>-0.341000</td>
<td>-0.325112</td>
<td>-0.303504</td>
<td>-0.303227</td>
<td>-0.289312</td>
<td>-0.293471</td>
<td>-0.267007</td>
<td>-0.235113</td>
<td>-0.255048</td>
</tr>
<tr>
<td>2012</td>
<td>0.030031</td>
<td>-0.049955</td>
<td>-0.026572</td>
<td>-0.015092</td>
<td>0.032386</td>
<td>0.027534</td>
<td>-0.004375</td>
<td>0.031107</td>
<td>0.115861</td>
<td>0.017141</td>
</tr>
<tr>
<td>2013</td>
<td>0.170485</td>
<td>0.312995</td>
<td>0.377450</td>
<td>0.384192</td>
<td>0.275290</td>
<td>0.301695</td>
<td>0.262052</td>
<td>0.151397</td>
<td>0.031816</td>
<td>0.213275</td>
</tr>
<tr>
<td>2014</td>
<td>0.526136</td>
<td>0.433754</td>
<td>0.464697</td>
<td>0.420801</td>
<td>0.411455</td>
<td>0.419831</td>
<td>0.442747</td>
<td>0.493381</td>
<td>0.627353</td>
<td>0.523959</td>
</tr>
<tr>
<td>2015</td>
<td>0.865446</td>
<td>0.910372</td>
<td>1.048544</td>
<td>0.921058</td>
<td>0.830989</td>
<td>0.809821</td>
<td>0.713525</td>
<td>0.642220</td>
<td>0.584860</td>
<td>0.868963</td>
</tr>
<tr>
<td>2016</td>
<td>-0.149154</td>
<td>-0.153286</td>
<td>-0.184407</td>
<td>-0.152738</td>
<td>-0.107150</td>
<td>-0.066949</td>
<td>-0.076453</td>
<td>-0.070614</td>
<td>-0.018879</td>
<td>-0.058761</td>
</tr>
<tr>
<td>2017</td>
<td>-0.148351</td>
<td>-0.143135</td>
<td>-0.138868</td>
<td>-0.133785</td>
<td>-0.081620</td>
<td>-0.042931</td>
<td>-0.006098</td>
<td>0.039563</td>
<td>0.108631</td>
<td>-0.068624</td>
</tr>
</tbody>
</table>
<p>未发现回报与PE有明显的线性关系。</p>
<p>如果将负值排除，回测净值如下表：</p>
<table>
<thead>
<tr>
<th>年度</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010-12-31</td>
<td>1.088860</td>
<td>1.066435</td>
<td>1.105948</td>
<td>1.147105</td>
<td>1.097676</td>
<td>1.190148</td>
<td>1.125225</td>
<td>1.070509</td>
<td>1.018974</td>
<td>0.959461</td>
</tr>
<tr>
<td>2011-12-31</td>
<td>0.781059</td>
<td>0.715559</td>
<td>0.756419</td>
<td>0.836331</td>
<td>0.778962</td>
<td>0.864488</td>
<td>0.815606</td>
<td>0.788771</td>
<td>0.749347</td>
<td>0.753110</td>
</tr>
<tr>
<td>2012-12-31</td>
<td>0.809129</td>
<td>0.673850</td>
<td>0.740019</td>
<td>0.837960</td>
<td>0.802289</td>
<td>0.865862</td>
<td>0.839644</td>
<td>0.793631</td>
<td>0.757754</td>
<td>0.844422</td>
</tr>
<tr>
<td>2013-12-31</td>
<td>0.927690</td>
<td>0.842666</td>
<td>0.992107</td>
<td>1.122267</td>
<td>1.040290</td>
<td>1.076552</td>
<td>1.036086</td>
<td>0.974755</td>
<td>0.859087</td>
<td>0.862083</td>
</tr>
<tr>
<td>2014-12-31</td>
<td>1.388888</td>
<td>1.173108</td>
<td>1.480387</td>
<td>1.553652</td>
<td>1.407905</td>
<td>1.444526</td>
<td>1.432692</td>
<td>1.356723</td>
<td>1.209633</td>
<td>1.362614</td>
</tr>
<tr>
<td>2015-12-31</td>
<td>2.541406</td>
<td>2.035929</td>
<td>2.783288</td>
<td>3.045823</td>
<td>2.534204</td>
<td>2.535974</td>
<td>2.369333</td>
<td>2.195839</td>
<td>1.914725</td>
<td>1.937750</td>
</tr>
<tr>
<td>2016-12-31</td>
<td>2.190961</td>
<td>1.710774</td>
<td>2.473333</td>
<td>2.621108</td>
<td>2.192689</td>
<td>2.297188</td>
<td>2.266580</td>
<td>2.040260</td>
<td>1.811089</td>
<td>1.824088</td>
</tr>
<tr>
<td>2017-12-31</td>
<td>1.868995</td>
<td>1.477998</td>
<td>2.154389</td>
<td>2.271461</td>
<td>2.010854</td>
<td>2.128336</td>
<td>2.197918</td>
<td>2.043338</td>
<td>1.889706</td>
<td>2.104439</td>
</tr>
</tbody>
</table>
<p>每年的回报如下：</p>
<table>
<thead>
<tr>
<th>年度</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<td>2011</td>
<td>-0.282682</td>
<td>-0.329018</td>
<td>-0.316045</td>
<td>-0.270920</td>
<td>-0.290353</td>
<td>-0.273630</td>
<td>-0.275162</td>
<td>-0.263181</td>
<td>-0.264607</td>
<td>-0.215070</td>
</tr>
<tr>
<td>2012</td>
<td>0.035938</td>
<td>-0.058289</td>
<td>-0.021682</td>
<td>0.001948</td>
<td>0.029947</td>
<td>0.001590</td>
<td>0.029472</td>
<td>0.006161</td>
<td>0.011219</td>
<td>0.121247</td>
</tr>
<tr>
<td>2013</td>
<td>0.146529</td>
<td>0.250525</td>
<td>0.340652</td>
<td>0.339284</td>
<td>0.296652</td>
<td>0.243330</td>
<td>0.233958</td>
<td>0.228223</td>
<td>0.133728</td>
<td>0.020915</td>
</tr>
<tr>
<td>2014</td>
<td>0.497147</td>
<td>0.392139</td>
<td>0.492164</td>
<td>0.384387</td>
<td>0.353377</td>
<td>0.341808</td>
<td>0.382793</td>
<td>0.391860</td>
<td>0.408045</td>
<td>0.580607</td>
</tr>
<tr>
<td>2015</td>
<td>0.829814</td>
<td>0.735500</td>
<td>0.880108</td>
<td>0.960428</td>
<td>0.799982</td>
<td>0.755576</td>
<td>0.653763</td>
<td>0.618487</td>
<td>0.582898</td>
<td>0.422083</td>
</tr>
<tr>
<td>2016</td>
<td>-0.137894</td>
<td>-0.159709</td>
<td>-0.111363</td>
<td>-0.139442</td>
<td>-0.134762</td>
<td>-0.094160</td>
<td>-0.043368</td>
<td>-0.070851</td>
<td>-0.054126</td>
<td>-0.058656</td>
</tr>
<tr>
<td>2017</td>
<td>-0.146952</td>
<td>-0.136065</td>
<td>-0.128953</td>
<td>-0.133397</td>
<td>-0.082928</td>
<td>-0.073503</td>
<td>-0.030293</td>
<td>0.001509</td>
<td>0.043409</td>
<td>0.153693</td>
</tr>
</tbody>
</table>
<p>与未排除负值结论相同，未发现回报与PE有明显的线性关系。但最低两个分位组收益最低表明PE并非越低越好。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/05/PB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/05/PB/" itemprop="url">PB因子</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-05T09:26:43+08:00">
                2017-09-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>将所有股票按PB等分成十组回测2010年以来的表现。净值如下表：</p>
<table>
<thead>
<tr>
<th>年度</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010-12-31</td>
<td>0.913731</td>
<td>1.005748</td>
<td>1.086478</td>
<td>1.133278</td>
<td>1.184108</td>
<td>1.084369</td>
<td>1.069243</td>
<td>1.159145</td>
<td>1.175195</td>
<td>1.120193</td>
</tr>
<tr>
<td>2011-12-31</td>
<td>0.743749</td>
<td>0.751398</td>
<td>0.760973</td>
<td>0.787854</td>
<td>0.816061</td>
<td>0.768577</td>
<td>0.729897</td>
<td>0.799045</td>
<td>0.755916</td>
<td>0.779777</td>
</tr>
<tr>
<td>2012-12-31</td>
<td>0.826109</td>
<td>0.810866</td>
<td>0.764764</td>
<td>0.805975</td>
<td>0.843122</td>
<td>0.742895</td>
<td>0.710337</td>
<td>0.732163</td>
<td>0.749739</td>
<td>0.824069</td>
</tr>
<tr>
<td>2013-12-31</td>
<td>0.879437</td>
<td>0.949035</td>
<td>0.946581</td>
<td>1.028943</td>
<td>1.036243</td>
<td>0.958524</td>
<td>0.933154</td>
<td>0.953574</td>
<td>0.972756</td>
<td>1.038909</td>
</tr>
<tr>
<td>2014-12-31</td>
<td>1.599215</td>
<td>1.554917</td>
<td>1.490360</td>
<td>1.531064</td>
<td>1.554863</td>
<td>1.392203</td>
<td>1.282149</td>
<td>1.337643</td>
<td>1.213129</td>
<td>1.375948</td>
</tr>
<tr>
<td>2015-12-31</td>
<td>2.258620</td>
<td>2.617103</td>
<td>2.642532</td>
<td>2.836788</td>
<td>3.023209</td>
<td>2.675991</td>
<td>2.433700</td>
<td>2.476892</td>
<td>2.232213</td>
<td>2.399691</td>
</tr>
<tr>
<td>2016-12-31</td>
<td>2.253148</td>
<td>2.506702</td>
<td>2.486296</td>
<td>2.620798</td>
<td>2.640262</td>
<td>2.438068</td>
<td>2.171948</td>
<td>2.053000</td>
<td>1.804224</td>
<td>1.858615</td>
</tr>
<tr>
<td>2017-12-31</td>
<td>2.577026</td>
<td>2.577051</td>
<td>2.400329</td>
<td>2.449873</td>
<td>2.480860</td>
<td>2.241321</td>
<td>2.048032</td>
<td>1.815645</td>
<td>1.480921</td>
<td>1.553711</td>
</tr>
</tbody>
</table>
<p>每年的回报如下：</p>
<table>
<thead>
<tr>
<th>年度</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
<th>4</th>
<th>5</th>
<th>6</th>
<th>7</th>
<th>8</th>
<th>9</th>
</tr>
</thead>
<tbody>
<tr>
<td>2010</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr>
<td>2011</td>
<td>-0.186030</td>
<td>-0.252897</td>
<td>-0.299597</td>
<td>-0.304801</td>
<td>-0.310822</td>
<td>-0.291222</td>
<td>-0.317371</td>
<td>-0.310660</td>
<td>-0.356774</td>
<td>-0.303891</td>
</tr>
<tr>
<td>2012</td>
<td>0.110736</td>
<td>0.079143</td>
<td>0.004983</td>
<td>0.023000</td>
<td>0.033160</td>
<td>-0.033415</td>
<td>-0.026798</td>
<td>-0.083702</td>
<td>-0.008172</td>
<td>0.056801</td>
</tr>
<tr>
<td>2013</td>
<td>0.064554</td>
<td>0.170398</td>
<td>0.237742</td>
<td>0.276645</td>
<td>0.229055</td>
<td>0.290255</td>
<td>0.313678</td>
<td>0.302407</td>
<td>0.297460</td>
<td>0.260707</td>
</tr>
<tr>
<td>2014</td>
<td>0.818452</td>
<td>0.638420</td>
<td>0.574467</td>
<td>0.487997</td>
<td>0.500481</td>
<td>0.452445</td>
<td>0.373995</td>
<td>0.402767</td>
<td>0.247105</td>
<td>0.324416</td>
</tr>
<tr>
<td>2015</td>
<td>0.412331</td>
<td>0.683114</td>
<td>0.773083</td>
<td>0.852821</td>
<td>0.944357</td>
<td>0.922127</td>
<td>0.898142</td>
<td>0.851684</td>
<td>0.840045</td>
<td>0.744028</td>
</tr>
<tr>
<td>2016</td>
<td>-0.002423</td>
<td>-0.042184</td>
<td>-0.059124</td>
<td>-0.076139</td>
<td>-0.126669</td>
<td>-0.088910</td>
<td>-0.107553</td>
<td>-0.171138</td>
<td>-0.191733</td>
<td>-0.225477</td>
</tr>
<tr>
<td>2017</td>
<td>0.143744</td>
<td>0.028064</td>
<td>-0.034576</td>
<td>-0.065219</td>
<td>-0.060374</td>
<td>-0.080698</td>
<td>-0.057053</td>
<td>-0.115614</td>
<td>-0.179193</td>
<td>-0.164049</td>
</tr>
</tbody>
</table>
<p>可以发现低PB分组无论是总回报还是稳定性都优于高PB分组。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/12/BigDrop/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/12/BigDrop/" itemprop="url">单日大跌后怎么办</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-12T16:52:59+08:00">
                2017-08-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>2017年8月11日上证下跌1.63%，深证下跌1.81%。股市单日大跌后怎么办？卖出止损还是买入超低？历史数据也许可以给我们一些参考。通过在<a href="https://www.joinquant.com/" target="_blank" rel="external">聚宽</a>平台对单日下跌2%以上的交易日进行统计，看看多少交易日可以收复失地，以下是代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> talib</div><div class="line"><span class="keyword">import</span> dateutil</div><div class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> dt</div><div class="line"><span class="keyword">from</span> dateutil.relativedelta <span class="keyword">import</span> *</div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="keyword">from</span> kuanke.user_space_api <span class="keyword">import</span> *</div><div class="line"><span class="keyword">except</span>:</div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="keyword">from</span> jqdata <span class="keyword">import</span> *</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">9999</span>)</div><div class="line">pd.set_option(<span class="string">'precision'</span>, <span class="number">3</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">back</span><span class="params">(closes)</span>:</span></div><div class="line">    back_index = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(closes)):</div><div class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(i+<span class="number">1</span>, len(closes)):</div><div class="line">            <span class="keyword">if</span> closes[j] &gt; closes[i]:</div><div class="line">                back_index.append(j)</div><div class="line">                <span class="keyword">break</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            back_index.append(<span class="keyword">None</span>)</div><div class="line">    <span class="keyword">return</span> back_index</div><div class="line"></div><div class="line"></div><div class="line">df = get_price(<span class="string">'399001.XSHE'</span>, count = <span class="number">4800</span>, end_date = <span class="string">'2017-8-12'</span>, fields=[<span class="string">'close'</span>])</div><div class="line">df[<span class="string">'ret'</span>] = df.pct_change()</div><div class="line">df.dropna(inplace=<span class="keyword">True</span>)</div><div class="line">df[<span class="string">'drop'</span>] = df[<span class="string">'ret'</span>] &lt; <span class="number">-0.02</span></div><div class="line">df[<span class="string">'above_date'</span>] = df[[<span class="string">'close'</span>]].apply(back)</div><div class="line"></div><div class="line">indexes = [int(i) <span class="keyword">if</span> <span class="keyword">not</span> math.isnan(i) <span class="keyword">else</span> <span class="keyword">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> df[<span class="string">'above_date'</span>].get_values()]</div><div class="line">df[<span class="string">'back_date'</span>] = [df.index[i] <span class="keyword">if</span> i <span class="keyword">else</span> <span class="keyword">None</span> <span class="keyword">for</span> i <span class="keyword">in</span> indexes]</div><div class="line">df[<span class="string">'back_days'</span>] = df[<span class="string">'back_date'</span>] - df.index</div><div class="line">df[df[<span class="string">'drop'</span>]][<span class="string">'back_days'</span>].value_counts() / len(df[df[<span class="string">'drop'</span>]].index)</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<table>
<thead>
<tr>
<th>天数</th>
<th>概率</th>
</tr>
</thead>
<tbody>
<tr>
<td>1天</td>
<td>0.519</td>
</tr>
<tr>
<td>3天</td>
<td>0.089</td>
</tr>
<tr>
<td>2天</td>
<td>0.061</td>
</tr>
<tr>
<td>4天</td>
<td>0.048</td>
</tr>
<tr>
<td>5天</td>
<td>0.029</td>
</tr>
<tr>
<td>6天</td>
<td>0.022</td>
</tr>
<tr>
<td>10天</td>
<td>0.016</td>
</tr>
<tr>
<td>7天</td>
<td>0.016</td>
</tr>
<tr>
<td>22天</td>
<td>0.013</td>
</tr>
<tr>
<td>8天</td>
<td>0.013</td>
</tr>
<tr>
<td>9天</td>
<td>0.010</td>
</tr>
<tr>
<td>12天</td>
<td>0.010</td>
</tr>
<tr>
<td>15天</td>
<td>0.006</td>
</tr>
<tr>
<td>16天</td>
<td>0.006</td>
</tr>
<tr>
<td>27天</td>
<td>0.006</td>
</tr>
<tr>
<td>17天</td>
<td>0.006</td>
</tr>
<tr>
<td>39天</td>
<td>0.003</td>
</tr>
<tr>
<td>2634天</td>
<td>0.003</td>
</tr>
<tr>
<td>25天</td>
<td>0.003</td>
</tr>
<tr>
<td>239天</td>
<td>0.003</td>
</tr>
<tr>
<td>56天</td>
<td>0.003</td>
</tr>
<tr>
<td>67天</td>
<td>0.003</td>
</tr>
<tr>
<td>11天</td>
<td>0.003</td>
</tr>
<tr>
<td>2606天</td>
<td>0.003</td>
</tr>
<tr>
<td>50天</td>
<td>0.003</td>
</tr>
<tr>
<td>104天</td>
<td>0.003</td>
</tr>
<tr>
<td>943天</td>
<td>0.003</td>
</tr>
<tr>
<td>45天</td>
<td>0.003</td>
</tr>
<tr>
<td>537天</td>
<td>0.003</td>
</tr>
<tr>
<td>31天</td>
<td>0.003</td>
</tr>
<tr>
<td>114天</td>
<td>0.003</td>
</tr>
<tr>
<td>365天</td>
<td>0.003</td>
</tr>
<tr>
<td>356天</td>
<td>0.003</td>
</tr>
<tr>
<td>158天</td>
<td>0.003</td>
</tr>
<tr>
<td>20天</td>
<td>0.003</td>
</tr>
<tr>
<td>68天</td>
<td>0.003</td>
</tr>
<tr>
<td>192天</td>
<td>0.003</td>
</tr>
<tr>
<td>40天</td>
<td>0.003</td>
</tr>
<tr>
<td>102天</td>
<td>0.003</td>
</tr>
<tr>
<td>43天</td>
<td>0.003</td>
</tr>
<tr>
<td>60天</td>
<td>0.003</td>
</tr>
<tr>
<td>2596天</td>
<td>0.003</td>
</tr>
<tr>
<td>86天</td>
<td>0.003</td>
</tr>
<tr>
<td>18天</td>
<td>0.003</td>
</tr>
<tr>
<td>49天</td>
<td>0.003</td>
</tr>
<tr>
<td>173天</td>
<td>0.003</td>
</tr>
<tr>
<td>128天</td>
<td>0.003</td>
</tr>
<tr>
<td>21天</td>
<td>0.003</td>
</tr>
<tr>
<td>83天</td>
<td>0.003</td>
</tr>
<tr>
<td>634天</td>
<td>0.003</td>
</tr>
<tr>
<td>410天</td>
<td>0.003</td>
</tr>
<tr>
<td>76天</td>
<td>0.003</td>
</tr>
</tbody>
</table>
<p>有数据的交易日总数3063天，其中314天下跌2%以上。也就是10.2%的交易日会下跌2%以上，平均一个月两天。单日大跌后，次日就收复失地的占51.9%，五个交易内收复失地的占74.6%。所以在上升和震荡趋势中，单日大跌完全没有必要恐慌，反而应该低吸。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/11/QuarterStat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/11/QuarterStat/" itemprop="url">股市的按季度回报统计</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-11T12:30:45+08:00">
                2017-08-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一年中哪个季度的回报最高？以下是在<a href="https://www.joinquant.com/" target="_blank" rel="external">聚宽</a>平台进行验证的代码。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> talib</div><div class="line"><span class="keyword">import</span> dateutil</div><div class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> dt</div><div class="line"><span class="keyword">from</span> dateutil.relativedelta <span class="keyword">import</span> *</div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="keyword">from</span> kuanke.user_space_api <span class="keyword">import</span> *</div><div class="line"><span class="keyword">except</span>:</div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="keyword">from</span> jqdata <span class="keyword">import</span> *</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">9999</span>)</div><div class="line">pd.set_option(<span class="string">'precision'</span>, <span class="number">3</span>)</div><div class="line">pd.set_option(<span class="string">'display.float_format'</span>, <span class="string">'&#123;:.2f&#125;'</span>.format)</div><div class="line"></div><div class="line">indexes = [</div><div class="line">    <span class="string">'000001.XSHG'</span>,   <span class="comment">#上证指数</span></div><div class="line">    <span class="string">'399001.XSHE'</span>,   <span class="comment">#深成指</span></div><div class="line">    <span class="string">'399005.XSHE'</span>,   <span class="comment">#中小板指</span></div><div class="line">    <span class="string">'399102.XSHE'</span>,   <span class="comment">#创业板综合指数</span></div><div class="line">    <span class="string">'000905.XSHG'</span>,   <span class="comment">#中证500</span></div><div class="line">    <span class="string">'000015.XSHG'</span>,   <span class="comment">#红利指数</span></div><div class="line">    <span class="string">'399932.XSHE'</span>,   <span class="comment">#中证消费</span></div><div class="line">    <span class="string">'399933.XSHE'</span>,   <span class="comment">#中证医药</span></div><div class="line">    <span class="string">'399396.XSHE'</span>,   <span class="comment">#国证食品</span></div><div class="line">    <span class="string">'399610.XSHE'</span>,   <span class="comment">#TMT50</span></div><div class="line">]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_indexes_display_name</span><span class="params">(indexes)</span>:</span></div><div class="line">    all_indexes = get_all_securities([<span class="string">'index'</span>])</div><div class="line"></div><div class="line">    <span class="keyword">return</span> all_indexes.loc[indexes][<span class="string">'display_name'</span>]</div><div class="line"></div><div class="line">index_names = get_indexes_display_name(indexes)</div><div class="line">prices = get_price(indexes, count = <span class="number">4800</span>, end_date = <span class="string">'2017-8-11'</span>, fields=[<span class="string">'close'</span>])</div><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> indexes:</div><div class="line">    closes = prices[<span class="string">'close'</span>][index]</div><div class="line">    closes_quarterly = closes.asfreq(<span class="string">'Q'</span>, method=<span class="string">'ffill'</span>)</div><div class="line"></div><div class="line">    return_quarterly = closes_quarterly.pct_change() * <span class="number">100</span></div><div class="line">    return_quarterly.dropna(inplace=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">    quarterly_stat = pd.DataFrame()</div><div class="line">    return_quarterly_group = return_quarterly.groupby([<span class="keyword">lambda</span> x: x.month])</div><div class="line">    return_quarterly_stat = return_quarterly_group.agg(</div><div class="line">         &#123;<span class="string">'count'</span>: <span class="string">'count'</span>, <span class="string">'min'</span>:<span class="string">'min'</span>,<span class="string">'max'</span>:<span class="string">'max'</span>, <span class="string">'mean'</span>:<span class="string">'mean'</span>, <span class="string">'positive'</span>: <span class="keyword">lambda</span> values: sum(x&gt;<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> values)&#125;)</div><div class="line">    return_quarterly_stat[<span class="string">'positive_pct'</span>] = return_quarterly_stat[<span class="string">'positive'</span>] / return_quarterly_stat[<span class="string">'count'</span>] * <span class="number">100</span></div><div class="line">    <span class="keyword">del</span> return_quarterly_stat[<span class="string">'positive'</span>]</div><div class="line">    return_quarterly_stat[<span class="string">'index'</span>] = index</div><div class="line">    return_quarterly_stat[<span class="string">'index_name'</span>] = index_names[index]</div><div class="line"></div><div class="line">    return_quarterly_stat.set_index([<span class="string">'index'</span>], append=<span class="keyword">True</span>, inplace=<span class="keyword">True</span>)</div><div class="line">    return_quarterly_stat = return_quarterly_stat[[<span class="string">'index_name'</span>, <span class="string">'count'</span>, <span class="string">'mean'</span>, <span class="string">'min'</span>, <span class="string">'max'</span>, <span class="string">'positive_pct'</span>]]</div><div class="line">    <span class="keyword">print</span> return_quarterly_stat</div></pre></td></tr></table></figure>
<p>结果如下：</p>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>2.37</td>
<td>-34.00</td>
<td>30.34</td>
<td>58.33</td>
</tr>
<tr>
<td>2</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>13</td>
<td>1.04</td>
<td>-22.86</td>
<td>28.80</td>
<td>38.46</td>
</tr>
<tr>
<td>3</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>1.99</td>
<td>-28.63</td>
<td>45.32</td>
<td>58.33</td>
</tr>
<tr>
<td>4</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>8.86</td>
<td>-20.62</td>
<td>52.67</td>
<td>66.67</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>4.43</td>
<td>-24.85</td>
<td>38.49</td>
<td>58.33</td>
</tr>
<tr>
<td>2</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>13</td>
<td>2.06</td>
<td>-29.55</td>
<td>46.76</td>
<td>61.54</td>
</tr>
<tr>
<td>3</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>1.94</td>
<td>-30.34</td>
<td>50.36</td>
<td>58.33</td>
</tr>
<tr>
<td>4</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>9.11</td>
<td>-14.20</td>
<td>53.63</td>
<td>50.00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>7.17</td>
<td>-18.22</td>
<td>46.60</td>
<td>66.67</td>
</tr>
<tr>
<td>2</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>1.35</td>
<td>-16.28</td>
<td>16.44</td>
<td>66.67</td>
</tr>
<tr>
<td>3</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>-0.46</td>
<td>-26.57</td>
<td>29.74</td>
<td>44.44</td>
</tr>
<tr>
<td>4</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>3.65</td>
<td>-13.92</td>
<td>26.94</td>
<td>44.44</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>5.38</td>
<td>-19.31</td>
<td>57.81</td>
<td>42.86</td>
</tr>
<tr>
<td>2</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>6.61</td>
<td>-15.11</td>
<td>30.95</td>
<td>71.43</td>
</tr>
<tr>
<td>3</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>6</td>
<td>0.91</td>
<td>-28.13</td>
<td>32.24</td>
<td>33.33</td>
</tr>
<tr>
<td>4</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>6.40</td>
<td>-8.33</td>
<td>39.11</td>
<td>57.14</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>6.87</td>
<td>-19.19</td>
<td>50.26</td>
<td>80.00</td>
</tr>
<tr>
<td>2</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>11</td>
<td>-0.45</td>
<td>-30.42</td>
<td>22.79</td>
<td>45.45</td>
</tr>
<tr>
<td>3</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>3.68</td>
<td>-31.24</td>
<td>41.78</td>
<td>50.00</td>
</tr>
<tr>
<td>4</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>4.35</td>
<td>-15.30</td>
<td>31.90</td>
<td>50.00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>5.16</td>
<td>-32.25</td>
<td>39.04</td>
<td>66.67</td>
</tr>
<tr>
<td>2</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>13</td>
<td>0.14</td>
<td>-27.89</td>
<td>27.42</td>
<td>46.15</td>
</tr>
<tr>
<td>3</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>1.95</td>
<td>-30.56</td>
<td>53.99</td>
<td>50.00</td>
</tr>
<tr>
<td>4</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>9.00</td>
<td>-24.43</td>
<td>52.91</td>
<td>58.33</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>1.35</td>
<td>-8.41</td>
<td>21.61</td>
<td>37.50</td>
</tr>
<tr>
<td>2</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>2.16</td>
<td>-13.58</td>
<td>19.42</td>
<td>50.00</td>
</tr>
<tr>
<td>3</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>7</td>
<td>3.70</td>
<td>-25.50</td>
<td>31.34</td>
<td>57.14</td>
</tr>
<tr>
<td>4</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>5.80</td>
<td>-8.53</td>
<td>30.05</td>
<td>62.50</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>2.88</td>
<td>-17.29</td>
<td>29.93</td>
<td>50.00</td>
</tr>
<tr>
<td>2</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>2.15</td>
<td>-10.81</td>
<td>19.52</td>
<td>50.00</td>
</tr>
<tr>
<td>3</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>7</td>
<td>4.23</td>
<td>-23.89</td>
<td>30.52</td>
<td>57.14</td>
</tr>
<tr>
<td>4</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>5.03</td>
<td>-7.99</td>
<td>26.97</td>
<td>62.50</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>1.31</td>
<td>-7.98</td>
<td>14.47</td>
<td>40.00</td>
</tr>
<tr>
<td>2</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>6.71</td>
<td>-5.65</td>
<td>23.94</td>
<td>60.00</td>
</tr>
<tr>
<td>3</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>4</td>
<td>-1.22</td>
<td>-26.58</td>
<td>13.23</td>
<td>75.00</td>
</tr>
<tr>
<td>4</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>4</td>
<td>7.32</td>
<td>-4.72</td>
<td>18.27</td>
<td>75.00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（季度）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>7.25</td>
<td>-19.23</td>
<td>51.25</td>
<td>57.14</td>
</tr>
<tr>
<td>2</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>4.99</td>
<td>-7.01</td>
<td>19.02</td>
<td>85.71</td>
</tr>
<tr>
<td>3</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>6</td>
<td>-3.52</td>
<td>-28.96</td>
<td>23.29</td>
<td>33.33</td>
</tr>
<tr>
<td>4</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>6</td>
<td>0.56</td>
<td>-14.02</td>
<td>24.34</td>
<td>50.00</td>
</tr>
</tbody>
</table>
<p>根据统计结果，每年三季度买股，持有到第二年一季度，并且小心第二年一月的回调，有很大的可能性取得正收益。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/11/MonthStat/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/11/MonthStat/" itemprop="url">股市的按月回报统计</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-11T08:30:45+08:00">
                2017-08-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>美国股市有所谓的五月效应，中国股市也有五穷六绝七翻身。我们可以通过历史数据验证是否存在月份效应。以下是在<a href="https://www.joinquant.com/" target="_blank" rel="external">聚宽</a>平台进行验证的代码。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> talib</div><div class="line"><span class="keyword">import</span> dateutil</div><div class="line"><span class="keyword">import</span> datetime <span class="keyword">as</span> dt</div><div class="line"><span class="keyword">from</span> dateutil.relativedelta <span class="keyword">import</span> *</div><div class="line"><span class="keyword">try</span>:</div><div class="line">    <span class="keyword">from</span> kuanke.user_space_api <span class="keyword">import</span> *</div><div class="line"><span class="keyword">except</span>:</div><div class="line">    <span class="keyword">pass</span></div><div class="line"><span class="keyword">from</span> jqdata <span class="keyword">import</span> *</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">9999</span>)</div><div class="line">pd.set_option(<span class="string">'precision'</span>, <span class="number">3</span>)</div><div class="line">pd.set_option(<span class="string">'display.float_format'</span>, <span class="string">'&#123;:.2f&#125;'</span>.format)</div><div class="line"></div><div class="line">indexes = [</div><div class="line">    <span class="string">'000001.XSHG'</span>,   <span class="comment">#上证指数</span></div><div class="line">    <span class="string">'399001.XSHE'</span>,   <span class="comment">#深成指</span></div><div class="line">    <span class="string">'399005.XSHE'</span>,   <span class="comment">#中小板指</span></div><div class="line">    <span class="string">'399102.XSHE'</span>,   <span class="comment">#创业板综合指数</span></div><div class="line">    <span class="string">'000905.XSHG'</span>,   <span class="comment">#中证500</span></div><div class="line">    <span class="string">'000015.XSHG'</span>,   <span class="comment">#红利指数</span></div><div class="line">    <span class="string">'399932.XSHE'</span>,   <span class="comment">#中证消费</span></div><div class="line">    <span class="string">'399933.XSHE'</span>,   <span class="comment">#中证医药</span></div><div class="line">    <span class="string">'399396.XSHE'</span>,   <span class="comment">#国证食品</span></div><div class="line">    <span class="string">'399610.XSHE'</span>,   <span class="comment">#TMT50</span></div><div class="line">]</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_indexes_display_name</span><span class="params">(indexes)</span>:</span></div><div class="line">    all_indexes = get_all_securities([<span class="string">'index'</span>])</div><div class="line"></div><div class="line">    <span class="keyword">return</span> all_indexes.loc[indexes][<span class="string">'display_name'</span>]</div><div class="line"></div><div class="line">index_names = get_indexes_display_name(indexes)</div><div class="line">prices = get_price(indexes, count = <span class="number">4800</span>, end_date = <span class="string">'2017-8-11'</span>, fields=[<span class="string">'close'</span>])</div><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> indexes:</div><div class="line">    closes = prices[<span class="string">'close'</span>][index]</div><div class="line">    closes_monthly = closes.asfreq(<span class="string">'M'</span>, method=<span class="string">'ffill'</span>)</div><div class="line"></div><div class="line">    return_monthly = closes_monthly.pct_change() * <span class="number">100</span></div><div class="line">    return_monthly.dropna(inplace=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">    monthly_stat = pd.DataFrame()</div><div class="line">    return_monthly_group = return_monthly.groupby([<span class="keyword">lambda</span> x: x.month])</div><div class="line">    return_monthly_stat = return_monthly_group.agg(</div><div class="line">         &#123;<span class="string">'count'</span>: <span class="string">'count'</span>, <span class="string">'min'</span>:<span class="string">'min'</span>,<span class="string">'max'</span>:<span class="string">'max'</span>, <span class="string">'mean'</span>:<span class="string">'mean'</span>, <span class="string">'positive'</span>: <span class="keyword">lambda</span> values: sum(x&gt;<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> values)&#125;)</div><div class="line">    return_monthly_stat[<span class="string">'positive_pct'</span>] = return_monthly_stat[<span class="string">'positive'</span>] / return_monthly_stat[<span class="string">'count'</span>] * <span class="number">100</span></div><div class="line">    <span class="keyword">del</span> return_monthly_stat[<span class="string">'positive'</span>]</div><div class="line">    return_monthly_stat[<span class="string">'index'</span>] = index</div><div class="line">    return_monthly_stat[<span class="string">'index_name'</span>] = index_names[index]</div><div class="line"></div><div class="line">    return_monthly_stat.set_index([<span class="string">'index'</span>], append=<span class="keyword">True</span>, inplace=<span class="keyword">True</span>)</div><div class="line">    return_monthly_stat = return_monthly_stat[[<span class="string">'index_name'</span>, <span class="string">'count'</span>, <span class="string">'mean'</span>, <span class="string">'min'</span>, <span class="string">'max'</span>, <span class="string">'positive_pct'</span>]]</div><div class="line">    <span class="keyword">print</span> return_monthly_stat</div></pre></td></tr></table></figure></p>
<p>统计结果如下：</p>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>-1.70</td>
<td>-22.65</td>
<td>9.33</td>
<td>50.00</td>
</tr>
<tr>
<td>2</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>13</td>
<td>2.80</td>
<td>-1.81</td>
<td>9.58</td>
<td>76.92</td>
</tr>
<tr>
<td>3</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>13</td>
<td>0.64</td>
<td>-20.14</td>
<td>13.94</td>
<td>46.15</td>
</tr>
<tr>
<td>4</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>13</td>
<td>3.80</td>
<td>-7.67</td>
<td>20.64</td>
<td>46.15</td>
</tr>
<tr>
<td>5</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>13</td>
<td>0.26</td>
<td>-9.70</td>
<td>13.96</td>
<td>46.15</td>
</tr>
<tr>
<td>6</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>13</td>
<td>-3.24</td>
<td>-20.31</td>
<td>12.40</td>
<td>53.85</td>
</tr>
<tr>
<td>7</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>13</td>
<td>2.37</td>
<td>-14.34</td>
<td>17.02</td>
<td>69.23</td>
</tr>
<tr>
<td>8</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>-1.59</td>
<td>-21.81</td>
<td>16.73</td>
<td>58.33</td>
</tr>
<tr>
<td>9</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>0.71</td>
<td>-8.11</td>
<td>6.62</td>
<td>58.33</td>
</tr>
<tr>
<td>10</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>1.72</td>
<td>-24.63</td>
<td>12.17</td>
<td>66.67</td>
</tr>
<tr>
<td>11</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>1.47</td>
<td>-18.19</td>
<td>14.22</td>
<td>66.67</td>
</tr>
<tr>
<td>12</td>
<td>000001.XSHG</td>
<td>上证指数</td>
<td>12</td>
<td>5.29</td>
<td>-5.74</td>
<td>27.45</td>
<td>58.33</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>-0.95</td>
<td>-25.64</td>
<td>14.83</td>
<td>50.00</td>
</tr>
<tr>
<td>2</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>13</td>
<td>3.72</td>
<td>-3.41</td>
<td>10.86</td>
<td>69.23</td>
</tr>
<tr>
<td>3</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>13</td>
<td>1.21</td>
<td>-15.94</td>
<td>18.06</td>
<td>53.85</td>
</tr>
<tr>
<td>4</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>13</td>
<td>3.55</td>
<td>-10.66</td>
<td>27.10</td>
<td>53.85</td>
</tr>
<tr>
<td>5</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>13</td>
<td>1.03</td>
<td>-11.25</td>
<td>19.13</td>
<td>53.85</td>
</tr>
<tr>
<td>6</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>13</td>
<td>-3.15</td>
<td>-22.22</td>
<td>14.21</td>
<td>38.46</td>
</tr>
<tr>
<td>7</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>13</td>
<td>3.06</td>
<td>-13.70</td>
<td>21.15</td>
<td>53.85</td>
</tr>
<tr>
<td>8</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>-2.33</td>
<td>-22.57</td>
<td>17.58</td>
<td>50.00</td>
</tr>
<tr>
<td>9</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>0.39</td>
<td>-9.70</td>
<td>5.87</td>
<td>58.33</td>
</tr>
<tr>
<td>10</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>1.91</td>
<td>-22.75</td>
<td>16.56</td>
<td>66.67</td>
</tr>
<tr>
<td>11</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>1.90</td>
<td>-19.93</td>
<td>22.61</td>
<td>66.67</td>
</tr>
<tr>
<td>12</td>
<td>399001.XSHE</td>
<td>深证成指</td>
<td>12</td>
<td>4.99</td>
<td>-7.99</td>
<td>22.35</td>
<td>66.67</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>-2.07</td>
<td>-25.27</td>
<td>10.72</td>
<td>44.44</td>
</tr>
<tr>
<td>2</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>4.79</td>
<td>-4.38</td>
<td>12.00</td>
<td>77.78</td>
</tr>
<tr>
<td>3</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>4.12</td>
<td>-8.63</td>
<td>20.74</td>
<td>55.56</td>
</tr>
<tr>
<td>4</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>0.33</td>
<td>-5.43</td>
<td>9.63</td>
<td>33.33</td>
</tr>
<tr>
<td>5</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>3.69</td>
<td>-7.76</td>
<td>25.01</td>
<td>66.67</td>
</tr>
<tr>
<td>6</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>-2.18</td>
<td>-15.86</td>
<td>7.78</td>
<td>55.56</td>
</tr>
<tr>
<td>7</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>10</td>
<td>2.08</td>
<td>-9.71</td>
<td>12.60</td>
<td>70.00</td>
</tr>
<tr>
<td>8</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>-2.96</td>
<td>G -19.39</td>
<td>12.50</td>
<td>44.44</td>
</tr>
<tr>
<td>9</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>-0.13</td>
<td>-12.06</td>
<td>8.83</td>
<td>55.56</td>
</tr>
<tr>
<td>10</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>0.62</td>
<td>-22.46</td>
<td>14.99</td>
<td>55.56</td>
</tr>
<tr>
<td>11</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>2.59</td>
<td>-11.96</td>
<td>16.95</td>
<td>66.67</td>
</tr>
<tr>
<td>12</td>
<td>399005.XSHE</td>
<td>中小板指</td>
<td>9</td>
<td>0.88</td>
<td>-12.67</td>
<td>15.18</td>
<td>44.44</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>-2.99</td>
<td>-28.70</td>
<td>13.38</td>
<td>42.86</td>
</tr>
<tr>
<td>2</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>5.62</td>
<td>-5.71</td>
<td>14.28</td>
<td>71.43</td>
</tr>
<tr>
<td>3</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>2.68</td>
<td>-8.25</td>
<td>24.18</td>
<td>28.57</td>
</tr>
<tr>
<td>4</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>0.60</td>
<td>-9.34</td>
<td>19.47</td>
<td>42.86</td>
</tr>
<tr>
<td>5</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>7.70</td>
<td>-7.20</td>
<td>33.82</td>
<td>71.43</td>
</tr>
<tr>
<td>6</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>-0.97</td>
<td>-18.09</td>
<td>8.24</td>
<td>57.14</td>
</tr>
<tr>
<td>7</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>-2.06</td>
<td>-13.33</td>
<td>12.00</td>
<td>28.57</td>
</tr>
<tr>
<td>8</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>6</td>
<td>0.77</td>
<td>-19.59</td>
<td>6.84</td>
<td>83.33</td>
</tr>
<tr>
<td>9</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>-0.00</td>
<td>-14.41</td>
<td>12.94</td>
<td>42.86</td>
</tr>
<tr>
<td>10</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>4.80</td>
<td>-7.43</td>
<td>19.20</td>
<td>57.14</td>
</tr>
<tr>
<td>11</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>4.15</td>
<td>-12.31</td>
<td>13.48</td>
<td>71.43</td>
</tr>
<tr>
<td>12</td>
<td>399102.XSHE</td>
<td>创业板综合指数</td>
<td>7</td>
<td>-2.39</td>
<td>-12.90</td>
<td>18.49</td>
<td>28.57</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>-1.39</td>
<td>-28.20</td>
<td>15.40</td>
<td>50.00</td>
</tr>
<tr>
<td>2</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>11</td>
<td>6.98</td>
<td>-2.17</td>
<td>17.30</td>
<td>90.91</td>
</tr>
<tr>
<td>3</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>11</td>
<td>3.37</td>
<td>-20.04</td>
<td>20.57</td>
<td>45.45</td>
</tr>
<tr>
<td>4</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>11</td>
<td>3.63</td>
<td>-6.68</td>
<td>33.41</td>
<td>36.36</td>
</tr>
<tr>
<td>5</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>11</td>
<td>2.28</td>
<td>-8.12</td>
<td>17.68</td>
<td>54.55</td>
</tr>
<tr>
<td>6</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>11</td>
<td>-6.04</td>
<td>-25.08</td>
<td>5.39</td>
<td>45.45</td>
</tr>
<tr>
<td>7</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>11</td>
<td>5.04</td>
<td>-13.24</td>
<td>22.82</td>
<td>81.82</td>
</tr>
<tr>
<td>8</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>-2.46</td>
<td>-23.53</td>
<td>11.22</td>
<td>50.00</td>
</tr>
<tr>
<td>9</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>-0.12</td>
<td>-12.95</td>
<td>11.03</td>
<td>60.00</td>
</tr>
<tr>
<td>10</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>0.14</td>
<td>-26.87</td>
<td>15.70</td>
<td>60.00</td>
</tr>
<tr>
<td>11</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>2.72</td>
<td>-11.09</td>
<td>17.89</td>
<td>70.00</td>
</tr>
<tr>
<td>12</td>
<td>000905.XSHG</td>
<td>中证500</td>
<td>10</td>
<td>2.20</td>
<td>-14.48</td>
<td>20.00</td>
<td>60.00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>0.43</td>
<td>-20.13</td>
<td>18.42</td>
<td>58.33</td>
</tr>
<tr>
<td>2</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>13</td>
<td>3.33</td>
<td>-1.91</td>
<td>9.51</td>
<td>84.62</td>
</tr>
<tr>
<td>3</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>13</td>
<td>0.51</td>
<td>-23.47</td>
<td>17.39</td>
<td>53.85</td>
</tr>
<tr>
<td>4</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>13</td>
<td>4.29</td>
<td>-8.54</td>
<td>30.91</td>
<td>53.85</td>
</tr>
<tr>
<td>5</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>13</td>
<td>0.27</td>
<td>-9.31</td>
<td>14.24</td>
<td>46.15</td>
</tr>
<tr>
<td>6</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>13</td>
<td>-4.51</td>
<td>-26.78</td>
<td>8.69</td>
<td>30.77</td>
</tr>
<tr>
<td>7</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>13</td>
<td>3.03</td>
<td>-15.23</td>
<td>25.39</td>
<td>61.54</td>
</tr>
<tr>
<td>8</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>-2.24</td>
<td>-23.80</td>
<td>19.54</td>
<td>41.67</td>
</tr>
<tr>
<td>9</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>0.70</td>
<td>-6.00</td>
<td>7.45</td>
<td>58.33</td>
</tr>
<tr>
<td>10</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>1.07</td>
<td>-28.61</td>
<td>13.39</td>
<td>66.67</td>
</tr>
<tr>
<td>11</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>2.16</td>
<td>-17.45</td>
<td>20.13</td>
<td>58.33</td>
</tr>
<tr>
<td>12</td>
<td>000015.XSHG</td>
<td>红利指数</td>
<td>12</td>
<td>5.39</td>
<td>-5.16</td>
<td>20.98</td>
<td>58.33</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>-4.45</td>
<td>-19.15</td>
<td>1.67</td>
<td>25.00</td>
</tr>
<tr>
<td>2</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>4.09</td>
<td>-0.68</td>
<td>11.97</td>
<td>87.50</td>
</tr>
<tr>
<td>3</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>2.06</td>
<td>-4.69</td>
<td>14.92</td>
<td>37.50</td>
</tr>
<tr>
<td>4</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>1.59</td>
<td>-3.60</td>
<td>14.44</td>
<td>50.00</td>
</tr>
<tr>
<td>5</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>1.74</td>
<td>-3.63</td>
<td>9.66</td>
<td>62.50</td>
</tr>
<tr>
<td>6</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>-1.19</td>
<td>-9.57</td>
<td>8.19</td>
<td>50.00</td>
</tr>
<tr>
<td>7</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>2.62</td>
<td>-11.04</td>
<td>10.76</td>
<td>75.00</td>
</tr>
<tr>
<td>8</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>-0.89</td>
<td>-9.67</td>
<td>11.58</td>
<td>50.00</td>
</tr>
<tr>
<td>9</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>0.22</td>
<td>-11.80</td>
<td>6.80</td>
<td>62.50</td>
</tr>
<tr>
<td>10</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>3.04</td>
<td>-3.58</td>
<td>10.96</td>
<td>62.50</td>
</tr>
<tr>
<td>11</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>2.60</td>
<td>-13.49</td>
<td>17.53</td>
<td>75.00</td>
</tr>
<tr>
<td>12</td>
<td>399932.XSHE</td>
<td>中证主要消费指数</td>
<td>8</td>
<td>0.17</td>
<td>-14.80</td>
<td>9.29</td>
<td>50.00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>-2.44</td>
<td>-24.63</td>
<td>11.96</td>
<td>37.50</td>
</tr>
<tr>
<td>2</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>3.63</td>
<td>-2.68</td>
<td>9.60</td>
<td>87.50</td>
</tr>
<tr>
<td>3</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>1.73</td>
<td>-7.00</td>
<td>16.62</td>
<td>50.00</td>
</tr>
<tr>
<td>4</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>1.34</td>
<td>-4.17</td>
<td>14.86</td>
<td>37.50</td>
</tr>
<tr>
<td>5</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>3.51</td>
<td>-6.19</td>
<td>16.26</td>
<td>75.00</td>
</tr>
<tr>
<td>6</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>-2.40</td>
<td>-15.56</td>
<td>5.19</td>
<td>62.50</td>
</tr>
<tr>
<td>7</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>1.89</td>
<td>-9.23</td>
<td>9.56</td>
<td>62.50</td>
</tr>
<tr>
<td>8</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>-1.36</td>
<td>-12.55</td>
<td>11.40</td>
<td>25.00</td>
</tr>
<tr>
<td>9</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>1.77</td>
<td>-12.40</td>
<td>8.16</td>
<td>62.50</td>
</tr>
<tr>
<td>10</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>3.96</td>
<td>-7.04</td>
<td>12.99</td>
<td>87.50</td>
</tr>
<tr>
<td>11</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>1.76</td>
<td>-10.42</td>
<td>10.01</td>
<td>75.00</td>
</tr>
<tr>
<td>12</td>
<td>399933.XSHE</td>
<td>中证医药卫生指数</td>
<td>8</td>
<td>-0.69</td>
<td>-12.53</td>
<td>9.35</td>
<td>50.00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>-5.77</td>
<td>-19.69</td>
<td>1.30</td>
<td>20.00</td>
</tr>
<tr>
<td>2</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>2.23</td>
<td>-1.41</td>
<td>4.34</td>
<td>80.00</td>
</tr>
<tr>
<td>3</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>5.38</td>
<td>-3.40</td>
<td>16.22</td>
<td>60.00</td>
</tr>
<tr>
<td>4</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>2.33</td>
<td>-3.89</td>
<td>15.11</td>
<td>60.00</td>
</tr>
<tr>
<td>5</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>3.25</td>
<td>-3.27</td>
<td>8.78</td>
<td>80.00</td>
</tr>
<tr>
<td>6</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>1.00</td>
<td>-8.59</td>
<td>7.95</td>
<td>40.00</td>
</tr>
<tr>
<td>7</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>0.78</td>
<td>-14.40</td>
<td>10.25</td>
<td>80.00</td>
</tr>
<tr>
<td>8</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>4</td>
<td>-2.08</td>
<td>-9.45</td>
<td>2.36</td>
<td>50.00</td>
</tr>
<tr>
<td>9</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>4</td>
<td>-0.44</td>
<td>-5.27</td>
<td>5.11</td>
<td>50.00</td>
</tr>
<tr>
<td>10</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>4</td>
<td>1.81</td>
<td>-4.91</td>
<td>9.82</td>
<td>50.00</td>
</tr>
<tr>
<td>11</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>-1.58</td>
<td>-15.80</td>
<td>3.21</td>
<td>60.00</td>
</tr>
<tr>
<td>12</td>
<td>399396.XSHE</td>
<td>国证食品</td>
<td>5</td>
<td>4.33</td>
<td>-3.35</td>
<td>11.76</td>
<td>60.00</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>month（月份）</th>
<th>index（指数）</th>
<th>index_name（指数名称）</th>
<th>count（样本数量）</th>
<th>mean（平均值）</th>
<th>min（最小值）</th>
<th>max（最大值）</th>
<th>positive_pct（上涨概率）</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>-1.83</td>
<td>-25.67</td>
<td>14.02</td>
<td>42.86</td>
</tr>
<tr>
<td>2</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>6.13</td>
<td>-6.01</td>
<td>14.03</td>
<td>71.43</td>
</tr>
<tr>
<td>3</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>2.66</td>
<td>-8.20</td>
<td>17.00</td>
<td>57.14</td>
</tr>
<tr>
<td>4</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>2.68</td>
<td>-4.79</td>
<td>20.57</td>
<td>42.86</td>
</tr>
<tr>
<td>5</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>5.28</td>
<td>-6.98</td>
<td>20.29</td>
<td>71.43</td>
</tr>
<tr>
<td>6</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>-2.11</td>
<td>-17.94</td>
<td>8.75</td>
<td>57.14</td>
</tr>
<tr>
<td>7</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>-1.70</td>
<td>-10.30</td>
<td>9.72</td>
<td>42.86</td>
</tr>
<tr>
<td>8</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>6</td>
<td>-1.56</td>
<td>-18.31</td>
<td>4.49</td>
<td>66.67</td>
</tr>
<tr>
<td>9</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>6</td>
<td>-0.67</td>
<td>-10.69</td>
<td>8.18</td>
<td>50.00</td>
</tr>
<tr>
<td>10</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>6</td>
<td>1.90</td>
<td>-7.96</td>
<td>17.94</td>
<td>50.00</td>
</tr>
<tr>
<td>11</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>6</td>
<td>-0.15</td>
<td>-9.76</td>
<td>7.17</td>
<td>66.67</td>
</tr>
<tr>
<td>12</td>
<td>399610.XSHE</td>
<td>TMT50</td>
<td>7</td>
<td>-1.02</td>
<td>-11.42</td>
<td>13.86</td>
<td>42.86</td>
</tr>
</tbody>
</table>
<p>统计结果中可以发现2月是全年中上涨概率最高并且回报平均值也较高的月份，此时满仓是比较好的选择。另外7月、10月、11月也是比较好的月份。相反1月、6月、8月的回报平均值为负，投资需谨慎。特别是6月，堪称中国股市的死亡之月，如果上半年已有较大的上涨，6月几乎必然有较大幅度的调整。古谚有云：五穷六绝七翻身。五月整体来看并没有特别危险，不过如果上半年已有较大涨幅，五月的中下旬就可能开始调整，并持续到六月。从统计数据上看，七翻身是没错的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/10/TradingSystem3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/10/TradingSystem3/" itemprop="url">从零构建股票交易系统 - 优化</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-10T20:59:45+08:00">
                2017-08-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在上一篇中我们创建了一个PB轮动的策略，但是策略收益差强人意。这一篇我们对这个策略进行优化，以提高收益。</p>
<h2 id="优化股票池"><a href="#优化股票池" class="headerlink" title="优化股票池"></a>优化股票池</h2><p>查看回测结果，可以发现单一的低PB因子选择的大部分是钢铁股。而钢铁股这种强周期股几年才有一次行情。所以策略大部分时间跑输基准也不奇怪了。</p>
<p>我们再加入一个因子，同比营业利润增长率。把选股的代码修改为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">fundamentals = get_fundamentals(query(valuation.code, valuation.pb_ratio</div><div class="line">                ).filter(</div><div class="line">                    valuation.pb_ratio &gt; <span class="number">0</span>,</div><div class="line">                    valuation.pb_ratio &lt; <span class="number">3</span>,</div><div class="line">                    indicator.inc_operation_profit_year_on_year &gt; <span class="number">15</span></div><div class="line">                ), context.previous_date)</div><div class="line">    fundamentals = fundamentals.set_index([<span class="string">'code'</span>])</div></pre></td></tr></table></figure>
<p>我们加入一个条件：同比营业利润增长率大于15%。这样策略就会将便宜（低PB）并且绩优（同比营业利润增长）的股票加入股票池，而不是仅仅选取便宜的股票。回测的结果如下：<br><img src="/uploads/2017081002.png" alt=""></p>
<p>仅仅加入一个因子就将收益提高了3倍，总收益从74.11%提高到216.91%，年化收益从7.7%提高到16.90%。并且几乎所有时间都是跑盈基准的。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/09/TradingSystem2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/09/TradingSystem2/" itemprop="url">从零构建股票交易系统 - 交易</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-09T21:03:41+08:00">
                2017-08-09
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>根据基本面数据分析的结果，PB是一个影响股票价格的效果显著的因子。我们可以使用这个因子开发一个PB轮动的单因子交易系统。</p>
<h2 id="PB轮动交易系统"><a href="#PB轮动交易系统" class="headerlink" title="PB轮动交易系统"></a>PB轮动交易系统</h2><p>在<a href="https://www.joinquant.com" target="_blank" rel="external">聚宽</a>中创建一个交易策略。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 导入函数库</span></div><div class="line"><span class="keyword">import</span> jqdata</div><div class="line"></div><div class="line"><span class="comment"># 初始化函数，设定基准等等</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(context)</span>:</span></div><div class="line">    set_params(context)    <span class="comment">#1 设置策参数</span></div><div class="line"></div><div class="line">    <span class="comment"># 设定沪深300作为基准</span></div><div class="line">    set_benchmark(<span class="string">'000300.XSHG'</span>)</div><div class="line">    <span class="comment"># 开启动态复权模式(真实价格)</span></div><div class="line">    set_option(<span class="string">'use_real_price'</span>, <span class="keyword">True</span>)</div><div class="line">    <span class="comment"># 输出内容到日志 log.info()</span></div><div class="line">    log.info(<span class="string">'初始函数开始运行且全局只运行一次'</span>)</div><div class="line">    <span class="comment"># 过滤掉order系列API产生的比error级别低的log</span></div><div class="line">    <span class="comment"># log.set_level('order', 'error')</span></div><div class="line"></div><div class="line">    <span class="comment">### 股票相关设定 ###</span></div><div class="line">    <span class="comment"># 股票类每笔交易时的手续费是：买入时佣金万分之三，卖出时佣金万分之三加千分之一印花税, 每笔交易佣金最低扣5块钱</span></div><div class="line">    set_order_cost(OrderCost(close_tax=<span class="number">0.001</span>, open_commission=<span class="number">0.0003</span>, close_commission=<span class="number">0.0003</span>, min_commission=<span class="number">5</span>), type=<span class="string">'stock'</span>)</div><div class="line"></div><div class="line">    <span class="comment">## 运行函数（reference_security为运行时间的参考标的；传入的标的只做种类区分，因此传入'000300.XSHG'或'510300.XSHG'是一样的）</span></div><div class="line">      <span class="comment"># 开盘前运行</span></div><div class="line">    run_daily(before_market_open, time=<span class="string">'before_open'</span>, reference_security=<span class="string">'000300.XSHG'</span>)</div><div class="line">      <span class="comment"># 开盘时运行</span></div><div class="line">    run_daily(market_open, time=<span class="string">'open'</span>, reference_security=<span class="string">'000300.XSHG'</span>)</div><div class="line">      <span class="comment"># 收盘后运行</span></div><div class="line">    run_daily(after_market_close, time=<span class="string">'after_close'</span>, reference_security=<span class="string">'000300.XSHG'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">set_params</span><span class="params">(context)</span>:</span></div><div class="line">    g.trade_interval = <span class="number">21</span>   <span class="comment"># 轮动周期</span></div><div class="line">    g.stocks_to_buy = <span class="number">10</span>    <span class="comment"># 买入股票数量</span></div><div class="line">    g.counter = <span class="number">0</span></div><div class="line"></div><div class="line"><span class="comment">## 开盘前运行函数</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">before_market_open</span><span class="params">(context)</span>:</span></div><div class="line">    g.counter = g.counter + <span class="number">1</span></div><div class="line">    <span class="keyword">if</span> g.counter % g.trade_interval != <span class="number">1</span>:</div><div class="line">        <span class="keyword">return</span></div><div class="line"></div><div class="line">    fundamentals = get_fundamentals(query(valuation.code, valuation.pb_ratio</div><div class="line">                ).filter(</div><div class="line">                    valuation.pb_ratio &gt; <span class="number">0</span>,</div><div class="line">                    valuation.pb_ratio &lt; <span class="number">3</span></div><div class="line">                ), context.previous_date)</div><div class="line">    fundamentals = fundamentals.set_index([<span class="string">'code'</span>])</div><div class="line"></div><div class="line">    <span class="comment"># 要操作的股票：</span></div><div class="line">    g.stocks = list(fundamentals.sort(<span class="string">"pb_ratio"</span>, ascending = <span class="keyword">True</span>).index)[:g.stocks_to_buy]</div><div class="line"></div><div class="line"><span class="comment">## 开盘时运行函数</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">market_open</span><span class="params">(context)</span>:</span></div><div class="line">    <span class="keyword">if</span> g.counter % g.trade_interval != <span class="number">1</span>:</div><div class="line">        <span class="keyword">return</span></div><div class="line"></div><div class="line">    every_stock_amount = context.portfolio.total_value / g.stocks_to_buy</div><div class="line"></div><div class="line">    <span class="keyword">if</span> len(list(context.portfolio.positions.keys()))==<span class="number">0</span>:</div><div class="line">        <span class="keyword">if</span> len(g.stocks):</div><div class="line">            <span class="keyword">for</span> stock <span class="keyword">in</span> g.stocks:</div><div class="line">                order_target_value(stock, every_stock_amount)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">for</span> stock <span class="keyword">in</span> context.portfolio.positions.keys():</div><div class="line">            <span class="keyword">if</span> stock <span class="keyword">not</span> <span class="keyword">in</span> g.stocks:</div><div class="line">                order_target_value(stock, <span class="number">0</span>)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> len(g.stocks):</div><div class="line">            <span class="keyword">for</span> stock <span class="keyword">in</span> g.stocks:</div><div class="line">                order_target_value(stock, every_stock_amount)</div><div class="line"></div><div class="line"><span class="comment">## 收盘后运行函数</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">after_market_close</span><span class="params">(context)</span>:</span></div><div class="line">    <span class="keyword">pass</span></div></pre></td></tr></table></figure>
<p>上面的策略是买入市盈率最低的十只股票，每21天轮动一次。也就是每21天检测市盈率，卖出不符合条件的股票，买入符合条件的股票。</p>
<p>策略回测的结果如下：<br><img src="/uploads/2017081001.png" alt=""></p>
<p>策略从2010-1-1至2017-8-9收益74.11%，年化收益7.7%。并且有2015年以前都是跑输基准的。这个结果只能说是差强人意。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/08/TradingSystem1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/08/TradingSystem1/" itemprop="url">从零构建股票交易系统 - 股票池</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-08T08:32:56+08:00">
                2017-08-08
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>从零构建股票交易系统是一系列文章，阐述怎样从零开发一个可用的股票交易系统。开发平台使用<a href="https://www.joinquant.com" target="_blank" rel="external">聚宽</a>。</p>
<h2 id="基本面因子"><a href="#基本面因子" class="headerlink" title="基本面因子"></a>基本面因子</h2><p>股票与其它投资工具的一个显著的区别是股票投资的企业的股权，而企业是可以产生利润的。所以从长期来看，股票市场总体上不断上升的。但股票也有优劣之分，有的盈利，有的则亏损；有的弹性大，有的弹性小；有的成交量大，方便资金进出，有的成交量小，稍大的资金量就会引起股票价格的波动。本交易系统追求小资金量的收益最大化。目前沪深两市有超过3000支股票可供选择，通过什么方法从中筛选出合适的股票形成交易系统的股票池呢？既然我们追求收益最大化，可以使用倒推的方法，通过研究过去收益最大的股票的特征，可能会给我们一些启发。</p>
<h3 id="数据统计"><a href="#数据统计" class="headerlink" title="数据统计"></a>数据统计</h3><p>聚宽提供了丰富的基本面数据，具体数据种类可以查看：<a href="https://www.joinquant.com/data/dict/fundamentals" target="_blank" rel="external">聚宽股票财务数据</a>。以下代码获取过去一年涨幅排名靠前的股票，检查它们与基本面因子的关系。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</div><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</div><div class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</div><div class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</div><div class="line"><span class="keyword">import</span> myutils <span class="keyword">as</span> u</div><div class="line"></div><div class="line">pd.set_option(<span class="string">'display.notebook_repr_html'</span>, <span class="keyword">False</span>)</div><div class="line">pd.set_option(<span class="string">'display.max_rows'</span>, <span class="number">9999</span>)</div><div class="line">pd.set_option(<span class="string">'precision'</span>, <span class="number">3</span>)</div><div class="line"></div><div class="line">last_two_year_dt = u.shift_trading_day(u.today_dt, <span class="number">-480</span>)    <span class="comment"># 只检查上市至少上市两年的股票，排除新股。新股容易遭炒作。</span></div><div class="line">last_year_dt = u.shift_trading_day(u.today_dt, <span class="number">-240</span>)        <span class="comment"># 一年前</span></div><div class="line">yesterday_dt = u.shift_trading_day(u.today_dt, <span class="number">-1</span>)          <span class="comment"># 上个交易日</span></div><div class="line">stocks = get_all_securities(date=last_two_year_dt)</div><div class="line"></div><div class="line">prices_current = get_price(list(stocks.index), end_date=yesterday_dt, fields=[<span class="string">'close'</span>], skip_paused=<span class="keyword">False</span>, fq=<span class="string">'pre'</span>, count=<span class="number">1</span>)[<span class="string">'close'</span>].T.ix[:,<span class="number">0</span>]    <span class="comment">#上个交易日价格</span></div><div class="line">prices_last_year = get_price(list(stocks.index), end_date=last_year_dt, fields=[<span class="string">'close'</span>], skip_paused=<span class="keyword">False</span>, fq=<span class="string">'pre'</span>, count=<span class="number">1</span>)[<span class="string">'close'</span>].T.ix[:,<span class="number">0</span>]  <span class="comment"># 一年前价格</span></div><div class="line"></div><div class="line">pct_change = pd.DataFrame(&#123;<span class="string">'return'</span>: (prices_current - prices_last_year) / prices_last_year * <span class="number">100</span>&#125;)   <span class="comment"># 一年涨幅</span></div><div class="line"></div><div class="line"><span class="comment"># 获取基本面数据</span></div><div class="line">fundamentals = get_fundamentals(query(valuation.code, valuation.market_cap, valuation.circulating_market_cap, valuation.pe_ratio,</div><div class="line">                                      valuation.pe_ratio_lyr, valuation.pb_ratio, valuation.ps_ratio, valuation.pcf_ratio,</div><div class="line">                                      balance.cash_equivalents, balance.account_receivable, balance.advance_payment,</div><div class="line">                                      balance.other_receivable, balance.inventories,</div><div class="line">                                      balance.total_current_assets, balance.fixed_assets, balance.total_non_current_assets, balance.total_assets,</div><div class="line">                                      balance.accounts_payable, balance.advance_peceipts, balance.salaries_payable, balance.taxs_payable,</div><div class="line">                                      balance.total_current_liability, balance.total_non_current_liability, balance.total_liability, balance.paidin_capital,</div><div class="line">                                      balance.capital_reserve_fund, balance.surplus_reserve_fund, balance.retained_profit, balance.equities_parent_company_owners,</div><div class="line">                                      balance.total_owner_equities, balance.total_sheet_owner_equities,</div><div class="line">                                      income.total_operating_revenue, income.operating_revenue, income.total_operating_cost, income.operating_cost,</div><div class="line">                                      income.operating_tax_surcharges, income.sale_expense, income.administration_expense, income.financial_expense,</div><div class="line">                                      income.asset_impairment_loss, income.operating_profit, income.non_operating_revenue, income.non_operating_expense,</div><div class="line">                                      income.total_profit, income.income_tax_expense, income.net_profit, income.np_parent_company_owners, income.basic_eps,</div><div class="line">                                      income.diluted_eps, income.total_composite_income, income.ci_parent_company_owners,</div><div class="line">                                      indicator.eps, indicator.adjusted_profit, indicator.operating_profit, indicator.value_change_profit, indicator.roe,</div><div class="line">                                      indicator.inc_return, indicator.roa, indicator.net_profit_margin, indicator.gross_profit_margin, indicator.expense_to_total_revenue,</div><div class="line">                                      indicator.operation_profit_to_total_revenue, indicator.net_profit_to_total_revenue, indicator.operating_expense_to_total_revenue,</div><div class="line">                                      indicator.ga_expense_to_total_revenue, indicator.financing_expense_to_total_revenue, indicator.operating_profit_to_profit,</div><div class="line">                                      indicator.invesment_profit_to_profit, indicator.adjusted_profit_to_profit, indicator.goods_sale_and_service_to_revenue,</div><div class="line">                                      indicator.ocf_to_revenue, indicator.ocf_to_operating_profit, indicator.inc_total_revenue_year_on_year, indicator.inc_total_revenue_annual,</div><div class="line">                                      indicator.inc_revenue_year_on_year, indicator.inc_revenue_annual, indicator.inc_operation_profit_year_on_year, indicator.inc_operation_profit_annual,</div><div class="line">                                      indicator.inc_net_profit_year_on_year, indicator.inc_net_profit_annual, indicator.inc_net_profit_to_shareholders_year_on_year,</div><div class="line">                                      indicator.inc_net_profit_to_shareholders_annual</div><div class="line"></div><div class="line">            ).filter(</div><div class="line">                indicator.code.in_(list(stocks.index))</div><div class="line">            ), last_year_dt)   <span class="comment"># 取去年的数据，不能到当前的数据，否则就是使用了未来的数据</span></div><div class="line"></div><div class="line">fundamentals.index = fundamentals[<span class="string">'code'</span>]</div><div class="line">fundamentals[<span class="string">'peg'</span>] = fundamentals.apply(<span class="keyword">lambda</span> row: <span class="number">100000</span> <span class="keyword">if</span> row[<span class="string">'pe_ratio'</span>] &lt;= <span class="number">0</span> <span class="keyword">or</span> row[<span class="string">'inc_net_profit_year_on_year'</span>] &lt;=<span class="number">0</span> <span class="keyword">else</span> row[<span class="string">'pe_ratio'</span>] / row[<span class="string">'inc_net_profit_year_on_year'</span>],axis=<span class="number">1</span>)    <span class="comment"># 增加peg因子</span></div><div class="line">fundamentals.ix[fundamentals[<span class="string">'pe_ratio_lyr'</span>] &lt;<span class="number">0</span> , <span class="string">'pe_ratio_lyr'</span>] = <span class="number">10000</span>       <span class="comment"># 亏损股PE是负数，重置为一个大数。排序时，亏损股当作pe很高的股票。</span></div><div class="line">fundamentals.ix[fundamentals[<span class="string">'pe_ratio'</span>] &lt;<span class="number">0</span> , <span class="string">'pe_ratio'</span>] = <span class="number">100000</span>              <span class="comment"># 亏损股PE是负数，重置为一个大数。排序时，亏损股当作pe很高的股票。</span></div><div class="line"></div><div class="line"><span class="keyword">del</span> fundamentals[<span class="string">'code'</span>]</div><div class="line"></div><div class="line"><span class="keyword">for</span> col <span class="keyword">in</span> fundamentals.columns:</div><div class="line">    fundamentals[col+<span class="string">'_r'</span>] = np.round(fundamentals[col].rank(ascending = <span class="keyword">True</span>, method = <span class="string">'max'</span>, pct=<span class="keyword">True</span>) * <span class="number">100</span>)    <span class="comment"># 对每个因子进行排序</span></div><div class="line"></div><div class="line">df = pd.concat([fundamentals, pct_change], axis=<span class="number">1</span>)</div><div class="line">df = df.sort(<span class="string">'return'</span>, ascending = <span class="keyword">False</span>)       <span class="comment"># 根据涨幅排序</span></div><div class="line"></div><div class="line">write_file(<span class="string">'data/factors.csv'</span>, df.to_csv(header=<span class="keyword">True</span>), append=<span class="keyword">False</span>)   <span class="comment"># 保存所有数据</span></div><div class="line"></div><div class="line"><span class="keyword">for</span> col <span class="keyword">in</span> df.columns:</div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> col.endswith(<span class="string">'_r'</span>):</div><div class="line">        <span class="keyword">del</span> df[col]</div><div class="line"></div><div class="line">top_20_pct_len = int(df.shape[<span class="number">0</span>] * <span class="number">0.2</span>)</div><div class="line">top_20_pct_df = pd.DataFrame(df.ix[:top_20_pct_len, :])</div><div class="line"></div><div class="line">stat_df = top_20_pct_df.quantile([<span class="number">.25</span>, <span class="number">.5</span>, <span class="number">.75</span>])  <span class="comment"># 只统计0.25, 0.5, 0.75分位的数据</span></div><div class="line"></div><div class="line">write_file(<span class="string">'data/factors_stat.csv'</span>, stat_df.to_csv(header=<span class="keyword">True</span>), append=<span class="keyword">False</span>)   <span class="comment"># 保存0.25, 0.5, 0.75分位的数据</span></div></pre></td></tr></table></figure></p>
<h3 id="数据分析"><a href="#数据分析" class="headerlink" title="数据分析"></a>数据分析</h3><p>生成的统计数据查看<a href="/uploads/factors_stat.csv">账务因子统计</a>。统计数据是统计过去一年涨幅前20%的股票各账务因子在所有股票中的排序数值。从中选取几个因子举例：</p>
<table>
<thead>
<tr>
<th>分位数</th>
<th>market_cap_r</th>
<th>pe_ratio_r</th>
<th>pb_ratio_r</th>
<th>inventories_r</th>
<th>fixed_assets_r</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.25</td>
<td>27</td>
<td>15</td>
<td>10</td>
<td>39</td>
<td>47</td>
</tr>
<tr>
<td>0.5</td>
<td>56</td>
<td>40.5</td>
<td>31</td>
<td>66</td>
<td>74</td>
</tr>
<tr>
<td>0.75</td>
<td>84.25</td>
<td>79</td>
<td>59</td>
<td>86</td>
<td>90</td>
</tr>
</tbody>
</table>
<p>如果股票涨幅与某个账务因子是没有关联性的，那么分位数与这个因子排序数值应该相差不会太大。例如0.25分位对应的排序值就应该是25，0.5分位对应的排序值就应该是50，0.75分位对应的排序值就应该是75。以选取出的几个因子为例，market_cap（流通股本）对与股票涨幅没有影响，PE（市盈率）和PB（市净率）越小股票涨幅越大，inventories（存货）和fixed_assets（固定资产）越大股票涨幅越大。PE和PB越小越好容易理解，但为什么存货越大越好？似乎不符合逻辑。我认为可能的原因是过去一年小市值股票遭到市场抛弃，市值越大，存货绝对值越大。但我们的策略中应该不能使用存货作为一个因子，因为不符合逻辑。我们开发出一个新的因子：存货/固定资产，如果检测这个因子与股票涨幅相关，可以将它做为交易系统的一个选股因子。</p>
<p>我们只检测了一年的数据。市场在一段时间内可能会有不同的偏好，比如过去一年小市值股票表现不好，但过去三年小市值因子是有明显的作用的。可以修改以下两行代码，修改统计的日期，统计不同时间段的数据进行分析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">last_two_year_dt = u.shift_trading_day(u.today_dt, <span class="number">-480</span>)    <span class="comment"># -480可以修改为-1000</span></div><div class="line">last_year_dt = u.shift_trading_day(u.today_dt, <span class="number">-240</span>)        <span class="comment"># -240可以修改为-720</span></div></pre></td></tr></table></figure>
<p>根据<a href="https://item.jd.com/11397927.html" target="_blank" rel="external">投资策略实战分析</a>，以下因子可能是有显著效应的，可以重点关注。</p>
<ul>
<li>市值</li>
<li>市盈率</li>
<li>现金流</li>
<li>EBIT对企业价值的比率</li>
<li>价格对现金流的比率</li>
<li>价格对销售额的比率</li>
<li>价格对账面价值的比率</li>
<li>股息率</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/07/mssys2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/07/mssys2/" itemprop="url">Windows下的Bash环境</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-07T11:23:20+08:00">
                2017-08-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>msys2：<a href="http://www.msys2.org/" target="_blank" rel="external">网址</a><br>ConEmu：<a href="https://conemu.github.io/" target="_blank" rel="external">网址</a></p>
<h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="在ConEmu中创建msys任务"><a href="#在ConEmu中创建msys任务" class="headerlink" title="在ConEmu中创建msys任务"></a>在ConEmu中创建msys任务</h3><p>打开ConEmu设置，创建一个任务。</p>
<p><img src="/uploads/2017080701.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">set MSYS2_PATH_TYPE=inherit &amp; set CHERE_INVOKING=1 &amp; %ConEmuDrive%\software\msys\usr\bin\zsh.exe --login -i -new_console:C:&quot;%ConEmuDrive%\msys64\msys2.ico&quot;</div></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/07/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="长毛大好">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="长毛大好的根据地">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/08/07/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-07T10:22:37+08:00">
                2017-08-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/avatar.png"
               alt="长毛大好" />
          <p class="site-author-name" itemprop="name">长毛大好</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">4</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              Links
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="https://www.joinquant.com/" title="聚宽" target="_blank">聚宽</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">长毛大好</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Gemini
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  
    

    
  





  






  





  

  

  

  

  

  

</body>
</html>
